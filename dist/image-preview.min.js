!function(i,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(i=i||self).ImagePreview=t()}(this,function(){"use strict";function t(i,t){this.set={autoPlay:t.autoPlay||!1,speed:t.speed||200,interval:t.interval||3e3,slider_dis:t.slider_dis||50,distance:t.distance||"level",loop:t.loop||!1},this.ContainerId=i,this.Init(),this.touchEvent()}function e(){var i,i=((i=document.createElement("div")).className="image-preview-wrap",i.id="Image-preveiw",i.innerHTML=str,i);document.body.appendChild(i);new t("Image-preveiw")}function i(){}return t.prototype={Init:function(){this.container=document.getElementById(this.ContainerId),this.swiperWrap=this.container.children[0],this.swiperLi=this.swiperWrap.children,this.count=this.swiperLi.length,this.pointerWrap=this.container.children[1],this.createPointerLi(this.count),this.pointerLi=this.pointerWrap.children,this.index=0,this.computeWidth("init")},computeWidth:function(i){this.w=this.container.offsetWidth,"init"==i?this.set.loop?(this.loopIndex=this.count+2,this.createLi(),this.translated(-this.w*(this.index+1),this.index)):(this.loopIndex=this.count,this.translated(-this.w*this.index,this.index)):this.translated(-this.w*this.index,this.index),this.swiperWrap.style.width=this.w*this.loopIndex+"px";for(var t=0;t<this.loopIndex;t++)this.swiperLi[t].style.width=this.w+"px"},createLi:function(){var i=document.createElement("li");i.innerHTML=this.swiperLi[0].innerHTML,this.swiperWrap.appendChild(i),(i=document.createElement("li")).innerHTML=this.swiperLi[this.swiperLi.length-2].innerHTML,this.swiperWrap.insertBefore(i,this.swiperLi[0])},createPointerLi:function(i){for(var t="",e=0;e<i;e++)t+='<li data-index="'+e+'"></li>';try{this.pointerWrap.innerHTML=t}catch(i){throw new Error("请加指示器ul元素")}},translated:function(i,t){this.swiperWrap.style.transform="translate3d("+i+"px,0,0)",this.showPointer(t)},showPointer:function(i){for(var t=0,e=this.pointerLi.length;t<e;t++)this.pointerLi[t].className="";this.pointerLi[i].className="active"},touchEvent:function(){var e=this,s=0;this.end={x:0},this.Tstart=function(i){i=(i=i||event).targetTouches[0];e.start={x:i.pageX},i=e.swiperWrap.style.transform,s=i.match(/\d+/g)[1]},this.Tmove=function(i){var t=(i=i||event).targetTouches[0];i.preventDefault(),e.end={x:.7*(t.pageX-e.start.x)},e.swiperWrap.style.transitionDuration="0ms",e.translated(-s+e.end.x,e.index)},this.Tend=function(){e.end.x<-e.set.slider_dis?e.index++:e.end.x>e.set.slider_dis&&e.index--,e.end.x=0,e.finished()},this.swiperWrap.addEventListener("touchstart",this.Tstart),this.swiperWrap.addEventListener("touchmove",this.Tmove),this.swiperWrap.addEventListener("touchend",this.Tend)},finished:function(){this.swiperWrap.style.transitionDuration=this.set.speed+"ms",this.set.loop?this.loop():(this.index<0?this.index=0:this.index>this.count-1&&(this.index=this.count-1),this.translated(-this.index*this.w,this.index))},loop:function(){this.index>=this.count?(this.translated(-(this.index+1)*this.w,0),this.index=0,this.animateFinish()):this.index<0?(this.translated(0,this.count-1),this.index=this.count-1,this.animateFinish()):this.translated(-(this.index+1)*this.w,this.index)},animateFinish:function(){setTimeout(function(){this.swiperWrap.style.transitionDuration="0ms",this.translated(-this.w*(this.index+1),this.index)}.bind(this),this.set.speed)},run:function(i){this.index=this.index+i,this.set.loop||(this.index=this.index>this.count-1?0:this.index,this.index=this.index<0?this.count-1:this.index),this.finished()},sliderIndex:function(i){var t=1==this.set.loop?i+1:i;this.translated(-this.w*t,i),this.index=i}},i.open=function(i){i.index=i.index||0,i.list=i.list||[],e()},i.close=function(i){},i});
